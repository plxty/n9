# 4th stage (o): install sysatem
depends:
  - nixos.x

actions:
  # Last Step Ride
  # ==============
  - action: command.run
    command: nixos-rebuild
    args: [switch, --upgrade]
    variants:
      - where: "!vars.root.is_empty"
        command: nixos-install
        args: [--root, "{{ vars.root }}"]
